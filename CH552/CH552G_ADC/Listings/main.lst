C51 COMPILER V9.60.0.0   MAIN                                                              04/19/2024 22:11:44 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE main.c LARGE OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listing
                    -s\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "CH552.H"
   2          #include "System.h"
   3          #include "CH552_GPIO.h"
   4          #include "CH552_UART.h"
   5          #include "CH552_TIMER.h"
   6          #include "CH552_ADC.h"
   7                  
   8          char code test_string[] = "Booba";
   9          
  10          //Pins:
  11          // LED = P11
  12          // TEST = P14
  13          // AIN2 = P15
  14          // RXD = P30
  15          // TXD = P31
  16          // AIN3 = P32
  17          
  18          int main()
  19          {
  20   1              CfgFsys();      //CH559 clock selection configuration
  21   1              
  22   1              gpio_set_mode(GPIO_MODE_PP, GPIO_PORT_1, GPIO_PIN_1 | GPIO_PIN_4);
  23   1              gpio_set_mode(GPIO_MODE_INPUT, GPIO_PORT_1, GPIO_PIN_5);
  24   1              
  25   1              gpio_set_mode(GPIO_MODE_PP, GPIO_PORT_3, GPIO_PIN_1);
  26   1              gpio_set_mode(GPIO_MODE_INPUT, GPIO_PORT_3, GPIO_PIN_0 | GPIO_PIN_2);
  27   1              uart0_init(TIMER_1, BUAD_RATE, UART_0_P30_P31);
  28   1              
  29   1              adc_init(ADC_FAST);
  30   1              adc_schedule[0] = ADC_AIN2;
  31   1              adc_schedule[1] = ADC_AIN3;
  32   1              adc_schedule_len = 2;
  33   1              adc_init_schedule();
  34   1              
  35   1              timer_init(TIMER_0, NULL);
  36   1              timer_set_period(TIMER_0, FREQ_SYS / 1000ul);   //period is 1ms
  37   1              EA = 1; //enable interupts
  38   1              E_DIS = 0;
  39   1              
  40   1              //Blink LED once
  41   1              gpio_clear_pin(GPIO_PORT_1, GPIO_PIN_1);
  42   1              timer_long_delay(TIMER_0, 250);
  43   1              gpio_set_pin(GPIO_PORT_1, GPIO_PIN_1);
  44   1              timer_long_delay(TIMER_0, 250);
  45   1              uart_write_string(UART_0, test_string);
  46   1              
  47   1              while(TRUE)
  48   1              {       
  49   2                      adc_run_schedule(2);
  50   2                      timer_long_delay(TIMER_0, 50);
  51   2                      uart_write_byte(UART_0, adc_results[0]);
  52   2                      uart_write_byte(UART_0, adc_results[1]);
  53   2                      gpio_write_pin(GPIO_PORT_1, GPIO_PIN_1, !gpio_read_pin(GPIO_PORT_1, GPIO_PIN_1));
  54   2              }
C51 COMPILER V9.60.0.0   MAIN                                                              04/19/2024 22:11:44 PAGE 2   

  55   1      }
  56          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    207    ----
   CONSTANT SIZE    =      6    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
